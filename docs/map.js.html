<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: map.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: map.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>"use strict";

/** 
* Location search form above map.
* Allows user input.
*/
const searchForm = document.getElementById("search-form");

/**
 * Handles form submission for the map search bar
 * Fetches location data from the Nominatim API from user input
 * 
 * @param {Event} event - submit event from map search bar
 */
if (searchForm) {
    searchForm.addEventListener("submit", async function (event) {
        event.preventDefault();

        // Get and trim user input from search form
        const userInput = event.target.querySelector('input').value.trim();

        // Container for feeback message
        const emptyFieldMsg = document.querySelector('.empty-field');

        if (!userInput) {
            emptyFieldMsg.textContent = "Vänligen ange en plats";
            emptyFieldMsg.classList.add('show');

            setTimeout(() => {
                emptyFieldMsg.classList.remove('show');
            }, 2000);

            return;
        }

        // Encoded search bar user input
        const encodedInput = encodeURIComponent(userInput);
        
        // API URL requesting JSON response for encoded user input
        const url = `https://nominatim.openstreetmap.org/search?format=json&amp;q=${encodedInput}`;

        try {
            const response = await fetch(url);
            if (!response.ok) {
                throw new Error(`HTTP error! Status: ${response.status}`);
            }

            const data = await response.json();
            if (data.length === 0) {
                alert(`Inga resultat för ${userInput}. Vänligen testa igen.`);
                return;
            }

            // Get necessary data from API response
            const { lat, lon, display_name } = data[0];

            // Display location data on page
            const locationInfo = document.getElementById("location-info");
            locationInfo.innerHTML = `&lt;i>Plats: ${display_name}&lt;/i> &lt;br>
                                  &lt;i>Lat: ${lat}&lt;/i> &lt;br>
                                  &lt;i>Lon: ${lon}&lt;/i>`;

            // Move map marker to retrieved location
            const mapFrame = document.getElementById("map-frame");
            mapFrame.src = `https://www.openstreetmap.org/export/embed.html?bbox=${lon}%2C${lat}%2C${lon}%2C${lat}&amp;layer=mapnik&amp;marker=${lat}%2C${lon}`;

        } catch (error) {
            console.error("Error när plats skulle hämtas: ", error);
            alert("Något gick fel. Vänligen testa igen.");
        }
    });
}</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#createBarChart">createBarChart</a></li><li><a href="global.html#createPieChart">createPieChart</a></li><li><a href="global.html#getData">getData</a></li><li><a href="global.html#partyAnimation">partyAnimation</a></li><li><a href="global.html#searchForm">searchForm</a></li><li><a href="global.html#toggleMenu">toggleMenu</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.4</a> on Fri Feb 28 2025 12:00:47 GMT+0100 (Central European Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
